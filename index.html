<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Blitz Nexus Pro 3.0 - AI-Enhanced Scalping</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@400;600&display=swap');
        :root {
            --orange: #ff6b35; --blue: #00d4ff; --purple: #627eea; --btc: #f7931a;
            --green: #00ff88; --yellow: #ffb800; --red: #ff4757; --dark: #0a0e1a;
            --panel: rgba(255,107,53,0.03); --border: rgba(255,107,53,0.3);
            --text: #ffffff; --text2: rgba(255,255,255,0.7); --text3: rgba(255,255,255,0.5);
        }
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family:'Rajdhani',sans-serif; background:linear-gradient(135deg,var(--dark),#050810); color:var(--text); min-height:100vh; }
        .header { background:linear-gradient(90deg,var(--orange),var(--blue)); padding:15px; text-align:center; box-shadow:0 4px 20px rgba(255,107,53,0.3); position:relative; }
        .header h1 { font-family:'Orbitron'; font-size:2rem; font-weight:700; margin:0; text-transform:uppercase; letter-spacing:2px; }
        .header .subtitle { font-size:0.9rem; margin-top:5px; opacity:0.9; }
        .live { position:absolute; top:15px; right:20px; display:flex; align-items:center; background:rgba(0,0,0,0.3); padding:6px 12px; border-radius:20px; border:2px solid var(--green); font-size:0.8rem; }
        .dot { width:6px; height:6px; border-radius:50%; background:var(--green); margin-right:6px; animation:pulse 2s infinite; }
        @keyframes pulse {
            0% { opacity:1;}
            50% { opacity:0.3;}
            100% { opacity:1;}
        }
        .mode-toggle {
            margin:0 14px 0 0; font-size:1.02rem; font-family:'Rajdhani',sans-serif; font-weight:600;
            background: linear-gradient(90deg,var(--green),var(--red)); 
            background-size: 200% 100%;
            border:2px solid var(--border); border-radius:17px; color:var(--text); padding:7px 30px; 
            cursor:pointer; transition: background-position 0.4s, color 0.2s, box-shadow 0.2s;
            box-shadow:0 1.5px 7px 0 rgba(0,0,0,0.17), 0 1.5px 17px 0 rgba(0,255,136,0.10);
        }
        .mode-toggle.sim {background-position: 0 0; border-color: var(--green);}
        .mode-toggle.live {background-position: 100% 0; border-color: var(--red);}
        .mode-indicator { display:inline-block; width:11px; height:11px; border-radius:50%; background:var(--green); margin-left: 11px; border:1.3px solid #333;}
        .mode-indicator.live { background:var(--red);}
        .container { max-width:630px; margin:34px auto; background:var(--panel); border-radius:18px; padding:32px 22px 32px 22px; box-shadow:0 16px 46px -16px rgba(0,0,0,0.49);}
        .panel { background:rgba(255,255,255,0.02); border:1.2px solid var(--border); border-radius:15px; padding:16px; margin-bottom:24px;}
        .trade-form, .result-panel, .export-panel { margin-bottom:19px;}
        .row { display:flex; gap:12px; padding-bottom:8px;}
        .row label { flex:1.3; font-size:1.07rem; margin-right:8px;}
        .row select, .row input[type=text], .row input[type=datetime-local] { flex:2; font-size:1.07rem; padding:7px 8px; border:1px solid var(--border); border-radius:7px; background:var(--dark); color:var(--text);}
        .row select:focus, .row input:focus { outline: none; box-shadow:0 0 0 2px var(--orange);}
        .form-btns { display:flex; gap:13px; margin-top:7px;}
        .btn {
            font-family:'Rajdhani',sans-serif; font-weight:600;
            font-size:1.05rem; border:none; outline:none; padding:9px 24px;
            background:linear-gradient(90deg,var(--purple),var(--blue)); color:var(--text);
            border-radius:11px; cursor:pointer; transition: filter 0.19s, box-shadow 0.22s;
            box-shadow: 0 6px 24px -9px var(--blue);
        }
        .btn:active {filter: brightness(1.3);}
        .btn-orange {background:linear-gradient(90deg,var(--orange),var(--yellow)); color:var(--dark);}
        .btn.reset {background:linear-gradient(90deg,var(--red),var(--orange)); color:white;}
        .btn.export {background:linear-gradient(90deg,var(--green),var(--blue),var(--orange)); color:var(--dark);}
        .info-panel {background:rgba(0,212,255,0.08); border-left:7px solid var(--blue); border-radius:10px; margin-bottom:20px; padding:13px 19px;}
    </style>
</head>
<body>
    <div class="header">
        <h1>Crypto Blitz Nexus Pro 3.0</h1>
        <div class="subtitle">AI-Driven Trade Sim & Performance Tracker</div>
        <button id="modeToggle" class="mode-toggle sim">Sim Mode <span class="mode-indicator"></span></button>
        <span class="live" id="liveIndicator"><span class="dot"></span>MODE: <span id="liveText">SIM</span></span>
    </div>
    <div class="container">
        <div class="info-panel" id="aiSummary">
            <b>Nexus 3.0 AI:</b> Adaptive, backed by your trade entries, learning from outcome feedback. Toggle Sim/Live, track all, and export stats instantly.
        </div>
        <form id="tradeForm" class="trade-form panel">
            <div class="row">
                <label for="asset">Asset</label>
                <select id="asset" required>
                    <option value="">Select asset</option>
                    <option value="BTCUSDT">BTC/USDT</option>
                    <option value="ETHUSDT">ETH/USDT</option>
                    <option value="SOLUSDT">SOL/USDT</option>
                    <option value="BNBUSDT">BNB/USDT</option>
                    <option value="ADAUSDT">ADA/USDT</option>
                </select>
            </div>
            <div class="row">
                <label for="entryTime">Entry Time</label>
                <input type="datetime-local" id="entryTime" required>
            </div>
            <div class="row">
                <label for="side">Side</label>
                <select id="side" required>
                    <option value="">Long/Short</option>
                    <option value="Long">Long</option>
                    <option value="Short">Short</option>
                </select>
            </div>
            <div class="row">
                <label for="outcome">Outcome</label>
                <select id="outcome" required>
                    <option value="">Win/Loss</option>
                    <option value="Win">Win</option>
                    <option value="Loss">Loss</option>
                </select>
            </div>
            <div class="row">
                <label for="market">Market</label>
                <select id="market" required>
                    <option value="">Select</option>
                    <option value="Trending">Trending</option>
                    <option value="Range">Range</option>
                    <option value="Breakout">Breakout</option>
                    <option value="Choppy">Choppy</option>
                </select>
            </div>
            <div class="row">
                <label for="vol">Volatility</label>
                <select id="vol" required>
                    <option value="">Select</option>
                    <option value="High">High</option>
                    <option value="Medium">Medium</option>
                    <option value="Low">Low</option>
                </select>
            </div>
            <div class="form-btns">
                <button type="submit" class="btn btn-orange">Add Trade</button>
                <button type="button" class="btn reset" id="resetStats">Reset Stats</button>
                <button type="button" class="btn export" id="exportCSV">Export CSV</button>
            </div>
        </form>
        <div class="result-panel panel" id="scorePanel">
            <b>AI Trade Score:</b>
            <span id="aiScore">0</span> | <span id="aiStrength"></span>
        </div>
        <div class="export-panel panel" id="logPanel" style="margin-bottom:9px;">
            <b>Trade Journal</b>
            <ul id="tradeLog" style="min-height:44px;"></ul>
        </div>
    </div>
    <script>
        // Utility: Format date to readable string
        function fmt(ts) {
            const d = new Date(ts);
            return d.toLocaleString('en-US', {year: '2-digit', month: '2-digit', day:'2-digit', hour:'2-digit', minute:'2-digit'});
        }
        // ---- Persistent Storage Keys ----
        const TRADE_KEY = 'nexusTradesV3';
        const MODE_KEY = 'nexusTradeModeV3';
        // ---- Default Mode ----
        let tradeMode = localStorage.getItem(MODE_KEY) || 'sim';
        // ---- UI Elements ----
        const modeToggle = document.getElementById('modeToggle');
        const liveText = document.getElementById('liveText');
        const liveIndicator = document.getElementById('liveIndicator');
        const tradeForm = document.getElementById('tradeForm');
        const tradeLog = document.getElementById('tradeLog');
        const aiScore = document.getElementById('aiScore');
        const aiStrength = document.getElementById('aiStrength');
        const resetStats = document.getElementById('resetStats');
        const exportCSV = document.getElementById('exportCSV');
        // ---- Mode UI Setup ----
        function setModeUI(mode) {
            if (mode === 'live') {
                modeToggle.textContent = 'Live Mode ';
                modeToggle.classList.remove('sim');
                modeToggle.classList.add('live');
                liveIndicator.style.borderColor = 'var(--red)';
                liveText.textContent = 'LIVE';
                liveText.style.color = 'var(--red)';
                document.querySelector('.mode-indicator').classList.add('live');
            } else {
                modeToggle.textContent = 'Sim Mode ';
                modeToggle.classList.remove('live');
                modeToggle.classList.add('sim');
                liveIndicator.style.borderColor = 'var(--green)';
                liveText.textContent = 'SIM';
                liveText.style.color = 'var(--green)';
                document.querySelector('.mode-indicator').classList.remove('live');
            }
            let dot = document.createElement('span');
            dot.className = 'mode-indicator' + (mode === 'live' ? ' live' : '');
            modeToggle.appendChild(dot);
        }
        setModeUI(tradeMode);

        // ---- Trade Data Storage & Load ----
        function loadTrades(){
            let all = JSON.parse(localStorage.getItem(TRADE_KEY) || '{}');
            if (!all.sim) all.sim = [];
            if (!all.live) all.live = [];
            return all;
        }
        function saveTrades(tObj){ localStorage.setItem(TRADE_KEY, JSON.stringify(tObj)); }

        let trades = loadTrades();

        // ---- Trade Log Display ----
        function renderLog(){
            let tArr = trades[tradeMode] || [];
            if (!tArr.length) {
                tradeLog.innerHTML = '<li style="color:#999;">No trades logged yet.</li>';
            } else {
                tradeLog.innerHTML = tArr.map(t =>
                  `<li>[${fmt(t.time)}] <b>${t.asset}</b> <span style="color:${t.side==='Long'?'#0f0':'#f44'}">${t.side}</span> ${t.outcome==='Win'?'✅':'❌'} in <b>${t.market}</b> (${t.vol})</li>`
                ).join('');
            }
        }
        renderLog();
        // ---- Performance Score & Strength ----
        function analyzeAI(){
            let tArr = trades[tradeMode] || [];
            if (!tArr.length) {
                aiScore.textContent = '-';
                aiStrength.textContent = '--';
                return;
            }
            let wins = tArr.filter(t => t.outcome === 'Win').length;
            let rate = wins / tArr.length;
            aiScore.textContent = Math.round(rate*100);
            aiStrength.textContent =
                rate >= 0.85 ? 'Elite' :
                rate >= 0.66 ? 'Strong' :
                rate >= 0.45 ? 'Maturing' :
                'Learning';
        }
        analyzeAI();

        // ---- Mode Switching ----
        modeToggle.onclick = function(){
            tradeMode = (tradeMode === 'sim') ? 'live' : 'sim';
            localStorage.setItem(MODE_KEY, tradeMode);
            setModeUI(tradeMode);
            renderLog();
            analyzeAI();
            logEvent(`Mode switched to ${tradeMode.toUpperCase()}`);
        }

        // ---- Event Logger ----
        function logEvent(msg) {
            const tArr = trades[tradeMode] || [];
            const time = Date.now();
            tArr.push({
                asset: 'MODE',
                side: '-',
                outcome: '-',
                time, market: msg, vol: '-'
            });
            trades[tradeMode] = tArr;
            saveTrades(trades);
            renderLog();
        }

        // ---- Form Handler ----
        tradeForm.onsubmit = function(e){
            e.preventDefault();
            const asset = document.getElementById('asset').value;
            const entryTime = document.getElementById('entryTime').value;
            const side = document.getElementById('side').value;
            const outcome = document.getElementById('outcome').value;
            const market = document.getElementById('market').value;
            const vol = document.getElementById('vol').value;
            const tArr = trades[tradeMode] || [];
            tArr.push({
                asset, side, outcome,
                time: (new Date(entryTime)).getTime(),
                market, vol
            });
            trades[tradeMode] = tArr;
            saveTrades(trades);
            renderLog();
            analyzeAI();
            tradeForm.reset();
        };
        // ---- Reset Handler ----
        resetStats.onclick = function() {
            if (confirm('This will clear all trade logs for the current mode. Proceed?')) {
                trades[tradeMode] = [];
                saveTrades(trades);
                renderLog();
                analyzeAI();
            }
        };

        // ---- EXPORT CSV ----
        exportCSV.onclick = function() {
            let tArr = trades[tradeMode] || [];
            if (!tArr.length) return alert('No trades to export!');
            let csv = 'Asset,Side,Outcome,Time,Market,Volatility\n' +
                tArr.map(t => [
                    t.asset, t.side, t.outcome,
                    fmt(t.time).replace(',',''),
                    t.market, t.vol
                ].join(',')).join('\n');
            let blob = new Blob([csv], { type: 'text/csv' });
            let link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `nexusV3_${tradeMode}_log.csv`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        };

        // ---- On Load: Show Mode State ----
        window.onload = function() {
            setModeUI(tradeMode);
            renderLog();
            analyzeAI();
        }
    </script>
</body>
</html>
        // ---- Reset Handler ----
        resetStats.onclick = function() {
            if (confirm('This will clear all trade logs for the current mode. Proceed?')) {
                trades[tradeMode] = [];
                saveTrades(trades);
                renderLog();
                analyzeAI();
            }
        };

        // ---- EXPORT CSV ----
        exportCSV.onclick = function() {
            let tArr = trades[tradeMode] || [];
            if (!tArr.length) return alert('No trades to export!');
            let csv = 'Asset,Side,Outcome,Time,Market,Volatility\n' +
                tArr.map(t => [
                    t.asset, t.side, t.outcome,
                    fmt(t.time).replace(',',''),
                    t.market, t.vol
                ].join(',')).join('\n');
            let blob = new Blob([csv], { type: 'text/csv' });
            let link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `nexusV3_${tradeMode}_log.csv`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        };

        // ---- On Load: Show Mode State ----
        window.onload = function() {
            setModeUI(tradeMode);
            renderLog();
            analyzeAI();
        }
    </script>
</body>
</html>
