<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Blitz Nexus Pro 3.0 - AI-Enhanced Scalping</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@400;600&display=swap');
        :root {
            --orange: #ff6b35; --blue: #00d4ff; --purple: #627eea; --btc: #f7931a;
            --green: #00ff88; --yellow: #ffb800; --red: #ff4757; --dark: #0a0e1a;
            --panel: rgba(255,107,53,0.03); --border: rgba(255,107,53,0.3);
            --text: #ffffff; --text2: rgba(255,255,255,0.7); --text3: rgba(255,255,255,0.5);
        }
        /* ...[CSS styles here: see previous block, copy all styles section from earlier "...TRUNCATED" summary]... */
    </style>
</head>
<body>
    <div class="header">
        <div class="live"><div class="dot"></div>LIVE AI</div>
        <h1>Crypto Blitz Nexus Pro 3.0</h1>
        <div class="subtitle">Self-Learning AI Scalping Terminal - Bulletproof Breakeven Strategy</div>
    </div>
    <!-- Enhanced Control Panel with Audio Management -->
    <div class="controls">
        <div class="control-group">
            <label style="font-family:Orbitron;font-size:0.8rem;">Risk Mode:</label>
            <button class="toggle-btn active" id="riskMode" onclick="toggleRiskMode()">CONSERVATIVE</button>
        </div>
        <div class="control-group">
            <label style="font-family:Orbitron;font-size:0.8rem;">News Alert:</label>
            <button class="toggle-btn news-btn" id="newsMode" onclick="toggleNewsMode()">NORMAL</button>
        </div>
        <div class="control-group">
            <label style="font-family:Orbitron;font-size:0.8rem;">Audio:</label>
            <button class="toggle-btn test-audio" onclick="testAudio('low')">TEST</button>
            <button class="toggle-btn acknowledge-btn" id="acknowledgeBtn" onclick="acknowledgeAlert()" style="display:none">SILENCE</button>
        </div>
        <div class="control-group">
            <label style="font-family:Orbitron;font-size:0.8rem;">Scanning:</label>
            <span id="scanRate" style="color:var(--green);">ACTIVE</span>
        </div>
    </div>
    <!-- NEW: Performance Dashboard with Reset Button -->
    <div class="performance-panel">
        <div class="perf-header">
            <h3 class="perf-title">üìä AI PERFORMANCE ANALYTICS - BREAKEVEN STRATEGY</h3>
            <button class="reset-analytics" onclick="resetPerformanceAnalytics()">üîÑ RESET STATS</button>
        </div>
        <div class="perf-grid">
            <div class="perf-stat"> <div class="perf-value" id="totalTrades">0</div> <div class="perf-label">Total Trades</div></div>
            <div class="perf-stat"> <div class="perf-value" id="winRate">0%</div> <div class="perf-label">Win Rate</div></div>
            <div class="perf-stat"> <div class="perf-value" id="profitFactor">0.00</div> <div class="perf-label">Profit Factor</div></div>
            <div class="perf-stat"> <div class="perf-value" id="avgWin">$0</div> <div class="perf-label">Avg Win</div></div>
            <div class="perf-stat"> <div class="perf-value" id="avgLoss">$0</div> <div class="perf-label">Avg Loss</div></div>
            <div class="perf-stat"> <div class="perf-value" id="breakevenRate">0%</div> <div class="perf-label">Breakeven Rate</div></div>
        </div>
    </div>
    <div class="sessions">
        <h2>üåç Global Trading Sessions</h2>
        <div class="sessions-grid" id="sessionsGrid"></div>
        <div style="text-align:center;margin-top:10px;font-family:Orbitron;font-size:0.8rem;" id="nextInfo"></div>
    </div>
    <div class="container">
        <!-- ASSET PANELS BEGIN HERE -->
        <div class="assets-panel">
            <div class="asset-header bitcoin">
                <img src="https://cryptologos.cc/logos/bitcoin-btc-logo.png" class="asset-logo">
                <div>
                    <h2>BTC/USDT</h2>
                    <div class="asset-desc">AI-Boosted Scalping (1m - 15m)</div>
                </div>
                <div class="asset-stats">
                    <div class="price-label">Last:</div>
                    <div id="btcPrice" class="price">--</div>
                </div>
                <div class="asset-trend" id="btcTrend"></div>
            </div>
            <div class="signal-bar" id="btcSignals"></div>
            <div class="trade-btns">
                <button class="exec-btn long" onclick="executeTrade('BTCUSDT','Long')">Long üöÄ</button>
                <button class="exec-btn short" onclick="executeTrade('BTCUSDT','Short')">Short ‚õî</button>
                <button class="exec-btn flat" onclick="executeTrade('BTCUSDT','Flat')">Flat ‚öñÔ∏è</button>
            </div>
            <div class="journal-panel">
                <h4>Trade Journal</h4>
                <div class="trades-table-wrap">
                    <table class="trades-table" id="btcJournal"></table>
                </div>
            </div>
        </div>
        <div class="assets-panel">
            <div class="asset-header ethereum">
                <img src="https://cryptologos.cc/logos/ethereum-eth-logo.png" class="asset-logo">
                <div>
                    <h2>ETH/USDT</h2>
                    <div class="asset-desc">AI-Boosted Scalping (1m - 15m)</div>
                </div>
                <div class="asset-stats">
                    <div class="price-label">Last:</div>
                    <div id="ethPrice" class="price">--</div>
                </div>
                <div class="asset-trend" id="ethTrend"></div>
            </div>
            <div class="signal-bar" id="ethSignals"></div>
            <div class="trade-btns">
                <button class="exec-btn long" onclick="executeTrade('ETHUSDT','Long')">Long üöÄ</button>
                <button class="exec-btn short" onclick="executeTrade('ETHUSDT','Short')">Short ‚õî</button>
                <button class="exec-btn flat" onclick="executeTrade('ETHUSDT','Flat')">Flat ‚öñÔ∏è</button>
            </div>
            <div class="journal-panel">
                <h4>Trade Journal</h4>
                <div class="trades-table-wrap">
                    <table class="trades-table" id="ethJournal"></table>
                </div>
            </div>
        </div>
        <div class="assets-panel">
            <div class="asset-header solana">
                <img src="https://cryptologos.cc/logos/solana-sol-logo.png" class="asset-logo">
                <div>
                    <h2>SOL/USDT</h2>
                    <div class="asset-desc">AI-Boosted Scalping (1m - 15m)</div>
                </div>
                <div class="asset-stats">
                    <div class="price-label">Last:</div>
                    <div id="solPrice" class="price">--</div>
                </div>
                <div class="asset-trend" id="solTrend"></div>
            </div>
            <div class="signal-bar" id="solSignals"></div>
            <div class="trade-btns">
                <button class="exec-btn long" onclick="executeTrade('SOLUSDT','Long')">Long üöÄ</button>
                <button class="exec-btn short" onclick="executeTrade('SOLUSDT','Short')">Short ‚õî</button>
                <button class="exec-btn flat" onclick="executeTrade('SOLUSDT','Flat')">Flat ‚öñÔ∏è</button>
            </div>
            <div class="journal-panel">
                <h4>Trade Journal</h4>
                <div class="trades-table-wrap">
                    <table class="trades-table" id="solJournal"></table>
                </div>
            </div>
        </div>
        <!-- Add more asset panels as needed -->
    </div>
        <!-- BEGIN NEWS AND ALERTS PANEL -->
    <div class="news-panel" id="newsPanel">
        <h3>üö® Global News Alerts</h3>
        <div id="newsFeed" class="news-feed">Loading news...</div>
        <div id="newsIndicator" class="news-indicator"></div>
    </div>
    <!-- END NEWS AND ALERTS PANEL -->
    <!-- NOTIFICATIONS PANEL -->
    <div id="notificationPanel" class="notification-panel" style="display:none;">
        <div id="notificationMsg"></div>
        <button class="notify-close" onclick="closeNotification()">CLOSE</button>
    </div>
    <!-- JAVASCRIPT LOGIC -->
    <script>
    // --- BASIC UTILITIES ---
    function safeGet(key, def) {
        try { return JSON.parse(localStorage.getItem(key)) || def; }
        catch { return def; }
    }
    function safeSet(key, val) {
        localStorage.setItem(key, JSON.stringify(val));
    }

    // --- GLOBAL VARS ---
    const RISK_MODE_KEY = "nexusV3_risk";
    const NEWS_MODE_KEY = "nexusV3_news";
    const SESSIONS_KEY = "nexusV3_sessions";
    const PERFORMANCE_KEY = "nexusV3_performance";
    const TRADES_KEY = "nexusV3_trades";
    const JOURNALS = {BTCUSDT: "btcJournal", ETHUSDT: "ethJournal", SOLUSDT: "solJournal"};
    const PRICES_API = "https://api.binance.com/api/v3/ticker/price?symbol=";

    let riskMode = safeGet(RISK_MODE_KEY, "CONSERVATIVE");
    let newsMode = safeGet(NEWS_MODE_KEY, "NORMAL");

    // --- AUDIO ---
    let audioTested = false;
    function testAudio(level) {
        if ('speechSynthesis' in window) {
            let msg = new SpeechSynthesisUtterance("Alert: Nexus audio test successful.");
            msg.volume = level === "low" ? .1 : 1;
            window.speechSynthesis.speak(msg);
            audioTested = true;
        }
    }
    function acknowledgeAlert() {
        window.speechSynthesis.cancel();
        document.getElementById("acknowledgeBtn").style.display = "none";
    }
    // --- TOGGLE HANDLERS ---
    function toggleRiskMode() {
        if (riskMode === "CONSERVATIVE") { riskMode = "AGGRESSIVE"; }
        else { riskMode = "CONSERVATIVE"; }
        document.getElementById("riskMode").textContent = riskMode;
        safeSet(RISK_MODE_KEY, riskMode);
        showNotification("Risk mode set to: " + riskMode);
    }
    function toggleNewsMode() {
        if (newsMode === "NORMAL") { newsMode = "SUPPRESS"; }
        else { newsMode = "NORMAL"; }
        document.getElementById("newsMode").textContent = newsMode;
        safeSet(NEWS_MODE_KEY, newsMode);
        showNotification("News alert mode: " + newsMode);
    }
    // --- NOTIFICATION PANEL ---
    function showNotification(msg) {
        document.getElementById("notificationMsg").textContent = msg;
        document.getElementById("notificationPanel").style.display = "block";
    }
    function closeNotification() {
        document.getElementById("notificationPanel").style.display = "none";
    }
    // --- GLOBAL PRICE FETCHING ---
    function fetchPrice(asset, htmlId, trendId) {
        fetch(PRICES_API + asset)
        .then(resp => resp.json())
        .then(data => {
            let price = parseFloat(data.price).toFixed(2);
            document.getElementById(htmlId).textContent = price;
            updateTrend(asset, price, trendId);
        });
    }
    function updatePrices() {
        fetchPrice("BTCUSDT", "btcPrice", "btcTrend");
        fetchPrice("ETHUSDT", "ethPrice", "ethTrend");
        fetchPrice("SOLUSDT", "solPrice", "solTrend");
    }
    setInterval(updatePrices, 7000);
    updatePrices();

    let lastTrends = {};
    function updateTrend(asset, price, trendId) {
        if (!lastTrends[asset]) { lastTrends[asset] = price; }
        let trendDiv = document.getElementById(trendId);
        if (!trendDiv) return;
        if (price > lastTrends[asset]) {
            trendDiv.innerHTML = '<span style="color:var(--green)">‚ñ≤ Up</span>';
        } else if (price < lastTrends[asset]) {
            trendDiv.innerHTML = '<span style="color:var(--red)">‚ñº Down</span>';
        } else {
            trendDiv.innerHTML = '<span style="color:var(--yellow)">‚¶ø Uneventful</span>';
        }
        lastTrends[asset] = price;
    }
    // --- EXECUTE TRADE (Sim/Live) ---
    function executeTrade(asset, dir) {
        let price = document.getElementById(asset.toLowerCase().replace('usdt','')+'Price').textContent;
        if (!price || price === "--") return showNotification("Price data unavailable.");

        let journals = safeGet(TRADES_KEY, {});
        if (!journals[asset]) journals[asset] = [];
        let entry = {
            time: Date.now(),
            dir: dir,
            price: parseFloat(price),
            result: "",
            session: getCurrentSession(),
            risk: riskMode
        };
        journals[asset].push(entry);
        safeSet(TRADES_KEY, journals);
        renderJournal(asset);
        updatePerformance();
        showNotification("Trade: "+asset+" "+dir+" @ "+price);
    }
    function renderJournal(asset) {
        let journals = safeGet(TRADES_KEY, {});
        let data = journals[asset] || [];
        let table = document.getElementById(JOURNALS[asset]);
        if (!table) return;
        let html = "<tr><th>Time</th><th>Side</th><th>Price</th><th>Session</th><th>Risk</th></tr>";
        data.slice(-8).reverse().forEach(trade=>{
            html += "<tr><td>"+new Date(trade.time).toLocaleTimeString()+"</td><td>"+trade.dir+"</td><td>"+trade.price+"</td><td>"+trade.session+"</td><td>"+trade.risk+"</td></tr>";
        });
        table.innerHTML = html;
    }
    Object
    // --- NEWS FEED ---
    function fetchNews() {
        // Dummy data. Replace with real crypto news/feed fetch for production.
        const items = [
            { ts: Date.now(), txt: "BTC jumps as market volatility returns. AI signals recalibrating." },
            { ts: Date.now()-60000, txt: "Ethereum momentum continues - resistance level tested." },
            { ts: Date.now()-120000, txt: "Solana: On-chain volume spikes, trade signals elevated risk." },
            { ts: Date.now()-180000, txt: "Fed minutes released. AI rebalances for global session risk." }
        ];
        let html = items.map(n =>
            `<div class='news-item'><span class='ts'>${new Date(n.ts).toLocaleTimeString()}</span> - ${n.txt}</div>`
        ).join('');
        document.getElementById('newsFeed').innerHTML = html;
        document.getElementById('newsIndicator').textContent = "Last updated: "+new Date(items[0].ts).toLocaleTimeString();
    }
    setInterval(fetchNews, 25000);
    fetchNews();

    // --- RESET ANALYTICS ---
    function resetPerformanceAnalytics() {
        if (confirm("Reset all performance analytics and journals?")) {
            localStorage.removeItem(PERFORMANCE_KEY);
            localStorage.removeItem(TRADES_KEY);
            updatePerformance();
            Object.keys(JOURNALS).forEach(renderJournal);
        }
    }
    // --- EXPORT CSV ---
    function exportAllJournals() {
        let journals = safeGet(TRADES_KEY, {});
        let out = "Asset,Time,Side,Price,Session,Risk\n";
        Object.entries(journals).forEach(([asset, arr])=>{
            arr.forEach(t=>{
                out += [
                    asset, new Date(t.time).toLocaleString(), t.dir, t.price, t.session, t.risk
                ].join(",") + "\n";
            });
        });
        let blob = new Blob([out],{type:'text/csv'});
        let link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = "nexus3.0-trade-journals.csv";
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }
    // Add your export button in the relevant panel and attach: onclick="exportAllJournals()"

    // --- END OF SYSTEM ---
    </script>
</body>
</html>
